# 🔍 Tiny Cowork v2.0 트러블슈팅 및 현황 보고서

현재 기능 구현(v2.0) 과정에서 발생한 혼란과 기술적 이슈들을 정리했습니다. 롤백 여부를 판단하시기 전에 아래 내용을 참고해 주세요.

## 1. 🚨 현재 문제점 (Issues)

### A. TUI 모드에서의 불투명성 (Silent Failures)
- **증상**: `--tui` 옵션을 주었을 때 화면이 바뀌지만, 내부에서 에러가 나면 화면이 그냥 꺼지거나 'Idle' 상태로 멈춘 것처럼 보입니다.
- **원인**: `rich.live` 라이브러리가 표준 출력을 가로채기 때문에, 모델 로딩 에러나 파이썬 런타임 에러가 터미널에 뿌려지지 않고 사라집니다.

### B. CLI 인자 처리 오류 (Fixed)
- **증상**: `AttributeError: 'Namespace' object has no attribute 'thinking'`
- **원인**: 대시보드 코드를 넣으면서 기존에 있던 `--thinking` 인자 정의를 실수로 삭제했었습니다. (현재 수정 완료)

### C. 샌드박스/RAG 인식 불일치
- **증상**: 요약본 파일(`cowork_summary_v2.md`)이 생성되지 않음.
- **원인**: 플래너(Planner)가 분해해준 태스크 이름이 제가 코드에 넣은 "save", "write" 필터링 조건과 미세하게 맞지 않아, 파일 쓰기 로직을 타지 못하고 일반 챗(Chat)으로 처리되는 경우가 있습니다.

---

## 2. ✅ 지금까지 한 것 (Progress)

- **UI 프레임워크 구축**: 터미널에서도 에이전트 활동을 볼 수 있는 대시보드(`src/tiny_moa/ui/dashboard.py`) 구현.
- **병렬 엔진 기초**: 여러 작업을 동시에 돌릴 수 있는 `ParallelRunner` 클래스 생성.
- **Orchestrator v2**: 순차 실행에서 벗어나 TUI와 연동되는 새로운 실행 루프 설계.

---

## 3. 🛠️ 해결 방안 (Proposed Solutions)

1.  **디버그 모드 강화**: TUI를 끄고도 모든 과정을 상세히 볼 수 있는 `--verbose` 모드 최적화.
2.  **태스크 매칭 로직 정교화**: "A를 읽어라" -> "RAG", "B에 써라" -> "Writer"라는 매핑을 단순 키워드가 아닌 에이전트 타입(AgentType) 기반으로 엄격히 분리.
3.  **로그 파일 분리**: TUI 화면 뒤에서 일어나는 모든 일을 `cowork.log` 파일에 따로 기록하여, 화면이 꺼져도 원인을 파악할 수 있게 함.

---

## 💡 최종 제안: 롤백해야 할까요?

**"아니요, 조금만 더 기다려 주세요!"** ✋

현재 발생한 문제는 아키텍처의 결함이 아니라, **사용자 경험(UX)과 디버깅 편의성** 사이의 간극에서 오는 문제입니다. 코어 로직은 잘 짜여 있고, TUI 없이 실행했을 때의 결과를 보면 브레인이 정상적으로 계획을 세우고 있습니다.

**다음 작업**:
- TUI를 잠시 비활성화한 상태에서 **로직 안정성(파일 생성 보장)**을 먼저 완벽히 검증하겠습니다.
- 그 후, 검증된 로직 위에 TUI를 다시 얹어서 시각적으로 보여드리겠습니다.

**보고일:** 2026-01-26
**현재 상태:** 구현 80% 완료 (통합 및 디버깅 단계)
